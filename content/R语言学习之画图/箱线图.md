---
title: R语言-分类箱线图(box-plot)/循环箱线图
subtitle:
date: 2023-07-14T10:44:16+08:00
draft: false
type: posts
author:
  name:
  link:
  email:
  avatar:
description:
keywords:
license:
comment: false
weight: 0
tags:
  - R语言绘图
categories:
  - R语言绘图
hiddenFromHomePage: false
hiddenFromSearch: false
summary:
resources:
  - name: featured-image
    src: featured-image.jpg
  - name: featured-image-preview
    src: featured-image-preview.jpg
toc: true
math: false
lightgallery: false
password:
message:
repost:
  enable: true
  url:
---
{{< admonition type=abstract title="代码内容+数据结构" open=false >}}
```
library(ggplot2)
setwd("C:/Users/90500/Desktop/箱线图")
cycle<-list.files()
for (x in c(1:length(cycle))){
  y<-strsplit(cycle[x],"\\.")[[1]][4]
  print(y)
  data<-read.table(cycle[x],header=T)
  names(data)<-c("CHROM","POS","PI","Subpopulation")
p<-ggplot(data,aes(x=Subpopulation,y=PI,fill=Subpopulation) )+
  geom_boxplot(outlier.size = 0.1,outlier.color='grey',
               position = position_dodge(0.6),size=0.1,alpha=1)+
    #geom_jitter(aes(x = Subpopulation, y = PI,fill=Subpopulation), 
     #           width = 0.25 ,size = 0.8,shape=21,stroke = 0.03,show.legend = FALSE)+
    scale_fill_manual(values=c("#DC143C","#6495ED","#F08080","#F4A460","#9370DB"), 
                      labels = c("All","CA", "CM", "WA","WM"))+
    ylim(0,1)+labs(y="Polymorphism",x="")+
    theme_bw()+ggtitle(y)+
    theme(plot.title = element_text(hjust = 0.5,vjust=0,face='bold',size = 8,color='black'))+
    theme(axis.line=element_line(size=0.5,color="black"),
          axis.text= element_text(size= 8,face="bold"),
          axis.title = element_text(size = 10,face = "bold"))+
    theme(legend.position=c(0.89,0.83),
          legend.key=element_blank(),
          legend.text = element_text(size=12,face="bold"),
          legend.title =element_blank())
assign(paste("p", x, sep = ""), p)
}
p_all <- ggpubr::ggarrange(p2,p1,ncol=2,nrow=1,common.legend = T,legend = "right")#, labels = c('', ''), font.label = list(color = 'black')
print(p_all)
ggsave("C:/Users/90500/Desktop/pi.pdf",width=6,height=3)

All<-df[(which(df[,4]=='All')),]
CA<-df[(which(df[,4]=='CA')),]
CM<-df[(which(df[,4]=='CM')),]
WA<-df[(which(df[,4]=='WA')),]
WM<-df[(which(df[,4]=='WM')),]
median(All[,3]) ; median(CA[,3])
median(CM[,3]) ; median(WA[,3])
median(WM[,3])

#df<-rbind(CA,CM,WA,WM)
options(scipen=200)
colnames(df)
dim(df)
```
- 数据结构
```
CHROM	POS	PI	Subpopulation
chr01	1962829	0.210947	All
chr01	5067335	0.225896	All
chr01	7331619	0.165208	All
chr01	10956716	0.416442	All
chr01	13377192	0.45274	All
chr01	17074363	0.494319	All
chr01	19916332	0.267801	All
chr01	22342048	0.220498	All
chr01	26630344	0.199453	All
chr01	28267989	0.490641	All
chr01	29960422	0.144751	All
chr01	34020046	0.209153	All
chr02	121055	0.323351	All
chr02	4379784	0.500233	All
chr02	7273764	0.494646	All
chr02	9701588	0.491741	All
chr02	12830109	0.392768	All
chr02	15967027	0.15849	All
chr02	18077569	0.26156	All
chr02	21107534	0.235932	All
chr02	25693433	0.416628	All
chr02	26926543	0.0970524	All
chr03	427583	0.49782	All
chr03	4235465	0.479083	All
chr03	7199677	0.330393	All
chr03	10596387	0.11086	All
chr03	13901386	0.138677	All
chr03	16273524	0.240049	All
chr03	20484503	0.193714	All
chr03	22945631	0.401705	All
chr03	24154476	0.401423	All
chr03	28635971	0.475017	All
chr04	1762380	0.500247	All
chr04	8363280	0.440843	All
chr04	9801508	0.307679	All
chr04	12217470	0.492932	All
chr04	15240440	0.481795	All
chr04	19219096	0.49994	All
chr04	21008923	0.363507	All
chr04	24084958	0.388549	All
chr04	28699714	0.413367	All
chr04	31732809	0.479187	All
chr04	33004611	0.217042	All
chr05	372943	0.500248	All
chr05	5789228	0.252652	All
chr05	8026890	0.493009	All
chr05	9241304	0.106224	All
chr05	13626460	0.109257	All
chr05	17884734	0.12367	All
chr05	20383752	0.111435	All
chr05	23562898	0.402144	All
chr05	24606761	0.495915	All
chr05	28106166	0.206904	All
chr06	2086220	0.19658	All
chr06	4259980	0.282342	All
chr06	8693161	0.388816	All
chr06	11179108	0.151332	All
chr06	12134033	0.205445	All
chr06	16107749	0.38826	All
chr06	18005476	0.41452	All
chr06	21550416	0.132734	All
chr06	25522809	0.223381	All
chr06	27492897	0.148939	All
chr06	31809034	0.476896	All
chr06	35272523	0.426625	All
chr06	36029499	0.377093	All
chr07	2122519	0.24243	All
chr07	5373714	0.37962	All
chr07	8844747	0.267726	All
chr07	9757894	0.328853	All
chr07	13945321	0.361274	All
chr07	17138888	0.177683	All
chr07	20740106	0.499134	All
chr07	21017601	0.235271	All
chr07	25393745	0.111392	All
chr08	2829230	0.411889	All
chr08	5129344	0.427633	All
chr08	7208859	0.478892	All
chr08	9883063	0.223722	All
chr08	12651193	0.151835	All
chr08	17377683	0.155605	All
chr08	20401282	0.181488	All
chr08	21313259	0.451065	All
chr08	24044740	0.30711	All
chr08	27696842	0.170098	All
chr08	31922009	0.1453	All
chr08	33321661	0.443116	All
chr09	2085720	0.149609	All
chr09	3478767	0.484848	All
chr09	6283314	0.370642	All
chr09	11494498	0.471794	All
chr09	13469111	0.108754	All
chr09	17754201	0.496795	All
chr09	20413457	0.297275	All
chr09	20978786	0.475327	All
chr10	2629013	0.469974	All
chr10	5517442	0.483606	All
chr10	6131681	0.289056	All
chr10	10679647	0.439116	All
chr10	13063980	0.500284	All
chr10	16323088	0.268661	All
chr10	18915293	0.490103	All
chr10	23836819	0.120227	All
chr10	25169924	0.161962	All
chr11	2390244	0.437544	All
chr11	5805224	0.393423	All
chr11	8604428	0.145518	All
chr11	9126598	0.270146	All
chr11	13593024	0.180313	All
chr11	17824984	0.436043	All
chr11	20249101	0.291378	All
chr11	22083887	0.143614	All
chr11	26731386	0.299144	All
chr11	27089251	0.473794	All
chr11	30394628	0.363459	All
chr12	2241457	0.309434	All
chr12	4896854	0.375844	All
chr12	6562041	0.169011	All
chr12	9577036	0.327959	All
chr12	13747388	0.361299	All
chr12	18403942	0.498958	All
chr12	23762593	0.172016	All
chr12	24189363	0.357508	All
chr01	1962829	0.282681	CA
chr01	5067335	0.012987	CA
chr01	7331619	0.0254756	CA
chr01	10956716	0.0632374	CA
chr01	13377192	0.286125	CA
chr01	17074363	0.16637	CA
chr01	19916332	0.39326	CA
chr01	22342048	0.34632	CA
chr01	26630344	0.430028	CA
chr01	28267989	0.17038	CA
chr01	29960422	0.0509295	CA
chr01	34020046	0.397132	CA
chr02	121055	0.205459	CA
chr02	4379784	0.239718	CA
chr02	7273764	0.112147	CA
chr02	9701588	0.205459	CA
chr02	12830109	0.307699	CA
chr02	15967027	0.0509295	CA
chr02	18077569	0.120761	CA
chr02	21107534	0.428098	CA
chr02	25693433	0.237077	CA
chr02	26926543	0.0254756	CA
chr03	427583	0.13352	CA
chr03	4235465	0.110772	CA
chr03	7199677	0.194153	CA
chr03	10596387	0	CA
chr03	13901386	0	CA
chr03	16273524	0.16637	CA
chr03	20484503	0	CA
chr03	22945631	0.29798	CA
chr03	24154476	0.317246	CA
chr03	28635971	0.338936	CA
chr04	1762380	0.087344	CA
chr04	5950375	0.224979	CA
chr04	8363280	0.185277	CA
chr04	9801508	0.0261415	CA
chr04	12217470	0.0979322	CA
chr04	15240440	0.232662	CA
chr04	19219096	0.164433	CA
chr04	21008923	0.227485	CA
chr04	24084958	0.0895749	CA
chr04	28699714	0.255751	CA
chr04	31732809	0.0502895	CA
chr04	33004611	0.0991427	CA
chr05	372943	0.126862	CA
chr05	5789228	0.0389509	CA
chr05	8026890	0.13352	CA
chr05	9241304	0.0258043	CA
chr05	13626460	0.50255	CA
chr05	17884734	0	CA
chr05	20383752	0.0128205	CA
chr05	23562898	0.148188	CA
chr05	24606761	0.109429	CA
chr05	28106166	0.389992	CA
chr06	2086220	0.0379653	CA
chr06	4259980	0.157459	CA
chr06	8693161	0.191857	CA
chr06	11179108	0.0258043	CA
chr06	12134033	0.0131579	CA
chr06	16107749	0.12528	CA
chr06	18005476	0.126862	CA
chr06	21550416	0.0379653	CA
chr06	25522809	0	CA
chr06	27492897	0.0254756	CA
chr06	31809034	0.0991427	CA
chr06	35272523	0.0991427	CA
chr06	36029499	0.0258043	CA
chr07	2122519	0.199983	CA
chr07	5373714	0.157459	CA
chr07	8844747	0.120761	CA
chr07	9757894	0.215113	CA
chr07	13945321	0.0515859	CA
chr07	17138888	0	CA
chr07	20740106	0.288089	CA
chr07	21017601	0.442928	CA
chr07	25393745	0.0264877	CA
chr08	2829230	0.0389509	CA
chr08	5129344	0.0502895	CA
chr08	7208859	0.0744417	CA
chr08	9883063	0.157459	CA
chr08	12651193	0.0744417	CA
chr08	17377683	0.363578	CA
chr08	20401282	0.0632374	CA
chr08	21313259	0.0379653	CA
chr08	24044740	0	CA
chr08	27696842	0.355769	CA
chr08	31922009	0.0379653	CA
chr08	33321661	0.148188	CA
chr09	2085720	0.253019	CA
chr09	3478767	0.0744417	CA
chr09	6283314	0.0522595	CA
chr09	11494498	0.0763332	CA
chr09	13469111	0	CA
chr09	17754201	0.115003	CA
chr09	20413457	0.239718	CA
chr09	20978786	0.0624483	CA
chr10	2629013	0.131927	CA
chr10	5517442	0.142928	CA
chr10	6131681	0.500174	CA
chr10	10679647	0.224979	CA
chr10	13063980	0.220199	CA
chr10	16323088	0.343093	CA
chr10	18915293	0.197691	CA
chr10	23836819	0.13352	CA
chr10	25169924	0.12528	CA
chr11	2390244	0.157459	CA
chr11	5805224	0.297181	CA
chr11	8604428	0.120761	CA
chr11	9126598	0.317246	CA
chr11	13593024	0	CA
chr11	17824984	0.159374	CA
chr11	20249101	0.202327	CA
chr11	22083887	0.0258043	CA
chr11	26731386	0.0675019	CA
chr11	27089251	0.234491	CA
chr11	30394628	0.225317	CA
chr12	2241457	0.255751	CA
chr12	4896854	0.0632374	CA
chr12	6562041	0.0389509	CA
chr12	9577036	0.122231	CA
chr12	13747388	0.217723	CA
chr12	16278536	0.207792	CA
chr12	18403942	0.0979322	CA
chr12	23762593	0	CA
chr12	24189363	0.246499	CA
chr01	1962829	0.0885222	CM
chr01	5067335	0.207635	CM
chr01	7331619	0.135744	CM
chr01	10956716	0.469953	CM
chr01	13377192	0.316668	CM
chr01	17074363	0.490327	CM
chr01	19916332	0.123427	CM
chr01	22342048	0.0552489	CM
chr01	26630344	0.07161	CM
chr01	28267989	0.497972	CM
chr01	29960422	0.0352738	CM
chr01	34020046	0.0658418	CM
chr02	121055	0.145256	CM
chr02	4379784	0.499873	CM
chr02	7273764	0.464805	CM
chr02	9701588	0.496829	CM
chr02	12830109	0.176742	CM
chr02	15967027	0.0224512	CM
chr02	18077569	0.310364	CM
chr02	21107534	0.114398	CM
chr02	25693433	0.309811	CM
chr02	26926543	0.01129	CM
chr03	427583	0.494007	CM
chr03	4235465	0.386566	CM
chr03	7199677	0.265846	CM
chr03	10596387	0.00982781	CM
chr03	13901386	0.170818	CM
chr03	16273524	0.0628386	CM
chr03	20484503	0.228277	CM
chr03	22945631	0.336596	CM
chr03	24154476	0.341673	CM
chr03	28635971	0.406374	CM
chr04	1762380	0.496245	CM
chr04	8363280	0.311397	CM
chr04	9801508	0.351861	CM
chr04	12217470	0.413363	CM
chr04	15240440	0.452204	CM
chr04	19219096	0.470348	CM
chr04	21008923	0.229074	CM
chr04	24084958	0.421529	CM
chr04	28699714	0.375313	CM
chr04	31732809	0.475374	CM
chr04	33004611	0.244435	CM
chr05	372943	0.484775	CM
chr05	5789228	0.246256	CM
chr05	8026890	0.462018	CM
chr05	9241304	0.0933096	CM
chr05	13626460	0.0336445	CM
chr05	17884734	0.00805142	CM
chr05	20383752	0.0161934	CM
chr05	23562898	0.458651	CM
chr05	24606761	0.493695	CM
chr05	28106166	0.0863047	CM
chr06	2086220	0.228401	CM
chr06	4259980	0.326861	CM
chr06	8693161	0.154528	CM
chr06	11179108	0.14287	CM
chr06	12134033	0.142128	CM
chr06	16107749	0.226289	CM
chr06	18005476	0.306579	CM
chr06	21550416	0.0503215	CM
chr06	25522809	0.26296	CM
chr06	27492897	0.117461	CM
chr06	31809034	0.376153	CM
chr06	35272523	0.205655	CM
chr06	36029499	0.420606	CM
chr07	2122519	0.0803214	CM
chr07	5373714	0.421153	CM
chr07	8844747	0.255435	CM
chr07	9757894	0.0509434	CM
chr07	13945321	0.42473	CM
chr07	17138888	0.217359	CM
chr07	20740106	0.462987	CM
chr07	21017601	0.0405677	CM
chr07	25393745	0.00838914	CM
chr08	2829230	0.439946	CM
chr08	5129344	0.473815	CM
chr08	7208859	0.349169	CM
chr08	9883063	0.0554237	CM
chr08	12651193	0.0227799	CM
chr08	17377683	0.03973	CM
chr08	20401282	0.0303446	CM
chr08	21313259	0.466755	CM
chr08	24044740	0.327717	CM
chr08	27696842	0.0518906	CM
chr08	31922009	0.110648	CM
chr08	33321661	0.491388	CM
chr09	2085720	0.0161672	CM
chr09	3478767	0.49822	CM
chr09	6283314	0.422833	CM
chr09	11494498	0.355049	CM
chr09	13469111	0.138939	CM
chr09	17754201	0.4906	CM
chr09	20413457	0.204404	CM
chr09	20978786	0.481835	CM
chr10	2629013	0.315843	CM
chr10	5517442	0.500183	CM
chr10	6131681	0.178005	CM
chr10	10679647	0.240275	CM
chr10	13063980	0.467675	CM
chr10	16323088	0.0841009	CM
chr10	18915293	0.48431	CM
chr10	23836819	0.0351611	CM
chr10	25169924	0.0664316	CM
chr11	2390244	0.469041	CM
chr11	5805224	0.224795	CM
chr11	8604428	0.150197	CM
chr11	9126598	0.138874	CM
chr11	13593024	0.212683	CM
chr11	17824984	0.483046	CM
chr11	20249101	0.145327	CM
chr11	22083887	0.0774558	CM
chr11	26731386	0.235855	CM
chr11	27089251	0.4425	CM
chr11	30394628	0.208017	CM
chr12	2241457	0.114242	CM
chr12	4896854	0.436953	CM
chr12	6562041	0.211474	CM
chr12	9577036	0.240107	CM
chr12	13747388	0.283325	CM
chr12	16278536	0.23332	CM
chr12	18403942	0.493439	CM
chr12	23762593	0.196567	CM
chr12	24189363	0.0976583	CM
chr01	1962829	0.0975974	WA
chr01	5067335	0.413961	WA
chr01	7331619	0.379819	WA
chr01	10956716	0.0436996	WA
chr01	13377192	0.171528	WA
chr01	17074363	0.0743731	WA
chr01	19916332	0.368648	WA
chr01	22342048	0.341341	WA
chr01	26630344	0.250873	WA
chr01	28267989	0.110159	WA
chr01	29960422	0.493684	WA
chr01	34020046	0.293979	WA
chr02	121055	0.491432	WA
chr02	4379784	0.374278	WA
chr02	7273764	0.488247	WA
chr02	9701588	0.022345	WA
chr02	12830109	0.172005	WA
chr02	15967027	0.486574	WA
chr02	18077569	0.010989	WA
chr02	21107534	0.266616	WA
chr02	25693433	0.502825	WA
chr02	26926543	0.472936	WA
chr03	427583	0.215767	WA
chr03	4235465	0.326057	WA
chr03	7199677	0.0441821	WA
chr03	10596387	0.483091	WA
chr03	13901386	0.0549102	WA
chr03	16273524	0.350981	WA
chr03	20484503	0.0751707	WA
chr03	22945631	0.362302	WA
chr03	24154476	0.396115	WA
chr03	28635971	0.38802	WA
chr04	1762380	0.463998	WA
chr04	5950375	0.27161	WA
chr04	8363280	0.454128	WA
chr04	9801508	0.163344	WA
chr04	12217470	0.115394	WA
chr04	15240440	0.498821	WA
chr04	19219096	0.325724	WA
chr04	21008923	0.411933	WA
chr04	24084958	0.344849	WA
chr04	28699714	0.211364	WA
chr04	31732809	0.391203	WA
chr04	33004611	0.0220981	WA
chr05	372943	0.454128	WA
chr05	5789228	0.415093	WA
chr05	8026890	0.488247	WA
chr05	9241304	0.126452	WA
chr05	13626460	0	WA
chr05	17884734	0.502571	WA
chr05	20383752	0.469244	WA
chr05	23562898	0.0113636	WA
chr05	24606761	0.16288	WA
chr05	28106166	0.152085	WA
chr06	2086220	0.0337013	WA
chr06	4259980	0.0113636	WA
chr06	8693161	0.249898	WA
chr06	11179108	0.312367	WA
chr06	12134033	0.493506	WA
chr06	16107749	0.355932	WA
chr06	18005476	0.502624	WA
chr06	21550416	0.477964	WA
chr06	25522809	0	WA
chr06	27492897	0.298525	WA
chr06	31809034	0.261793	WA
chr06	35272523	0.0329609	WA
chr06	36029499	0.24513	WA
chr07	2122519	0.253247	WA
chr07	5373714	0.116613	WA
chr07	8844747	0.449438	WA
chr07	9757894	0.27957	WA
chr07	13945321	0	WA
chr07	17138888	0.0751707	WA
chr07	20740106	0.200597	WA
chr07	21017601	0.482257	WA
chr07	25393745	0.487941	WA
chr08	2829230	0.34761	WA
chr08	5129344	0.104426	WA
chr08	7208859	0.0743731	WA
chr08	9883063	0.32843	WA
chr08	12651193	0.498701	WA
chr08	17377683	0	WA
chr08	20401282	0.415921	WA
chr08	21313259	0.460832	WA
chr08	24044740	0.291883	WA
chr08	27696842	0.022345	WA
chr08	31922009	0.365673	WA
chr08	33321661	0	WA
chr09	2085720	0.502857	WA
chr09	3478767	0.0220981	WA
chr09	6283314	0.0228556	WA
chr09	11494498	0.232402	WA
chr09	13469111	0	WA
chr09	17754201	0.116613	WA
chr09	20413457	0.209293	WA
chr09	20978786	0.482682	WA
chr10	2629013	0.0220981	WA
chr10	5517442	0.133386	WA
chr10	6131681	0.466952	WA
chr10	10679647	0.0655113	WA
chr10	13063980	0.0955307	WA
chr10	16323088	0.479416	WA
chr10	18915293	0.417815	WA
chr10	23836819	0.454455	WA
chr10	25169924	0.469244	WA
chr11	2390244	0.330078	WA
chr11	5805224	0.464817	WA
chr11	8604428	0.0854128	WA
chr11	9126598	0.338751	WA
chr11	13593024	0.0436996	WA
chr11	17824984	0.0218566	WA
chr11	20249101	0.401834	WA
chr11	22083887	0.445693	WA
chr11	26731386	0.493506	WA
chr11	27089251	0.460832	WA
chr11	30394628	0.493684	WA
chr12	2241457	0.494696	WA
chr12	4896854	0.0432275	WA
chr12	6562041	0	WA
chr12	9577036	0.434855	WA
chr12	13747388	0.287024	WA
chr12	18403942	0.45059	WA
chr12	23762593	0.0641127	WA
chr12	24189363	0.281851	WA
chr01	1962829	0.0333333	WM
chr01	5067335	0.353902	WM
chr01	7331619	0.274987	WM
chr01	10956716	0.252247	WM
chr01	13377192	0.470054	WM
chr01	17074363	0.296668	WM
chr01	19916332	0.465362	WM
chr01	22342048	0.30452	WM
chr01	26630344	0.177684	WM
chr01	28267989	0.372656	WM
chr01	29960422	0.488136	WM
chr01	34020046	0.228451	WM
chr02	121055	0.412994	WM
chr02	4379784	0.508197	WM
chr02	7273764	0.479129	WM
chr02	9701588	0.430519	WM
chr02	12830109	0.499736	WM
chr02	15967027	0.427119	WM
chr02	18077569	0.150714	WM
chr02	21107534	0.345198	WM
chr02	25693433	0.451977	WM
chr02	26926543	0.252247	WM
chr03	427583	0.455315	WM
chr03	4235465	0.488136	WM
chr03	7199677	0.0966102	WM
chr03	10596387	0.389212	WM
chr03	13901386	0.0344828	WM
chr03	16273524	0.0936013	WM
chr03	20484503	0.235028	WM
chr03	22945631	0.415584	WM
chr03	24154476	0.336859	WM
chr03	28635971	0.499093	WM
chr04	1762380	0.506081	WM
chr04	5950375	0.177684	WM
chr04	8363280	0.508167	WM
chr04	9801508	0.215971	WM
chr04	12217470	0.480791	WM
chr04	15240440	0.3902	WM
chr04	19219096	0.448276	WM
chr04	21008923	0.508475	WM
chr04	24084958	0.296668	WM
chr04	28699714	0.312765	WM
chr04	31732809	0.499435	WM
chr04	33004611	0.389212	WM
chr05	372943	0.480791	WM
chr05	5789228	0.235028	WM
chr05	8026890	0.421658	WM
chr05	9241304	0.404548	WM
chr05	13626460	0.0322581	WM
chr05	17884734	0.39774	WM
chr05	20383752	0.432047	WM
chr05	23562898	0.188748	WM
chr05	24606761	0.499435	WM
chr05	28106166	0.130672	WM
chr06	2086220	0.317292	WM
chr06	4259980	0.241984	WM
chr06	8693161	0.485714	WM
chr06	11179108	0.0634585	WM
chr06	12134033	0.39774	WM
chr06	16107749	0.428571	WM
chr06	18005476	0.355368	WM
chr06	21550416	0.317292	WM
chr06	25522809	0.198068	WM
chr06	27492897	0.444209	WM
chr06	31809034	0.482285	WM
chr06	35272523	0.499736	WM
chr06	36029499	0.321429	WM
chr07	2122519	0.274987	WM
chr07	5373714	0.448276	WM
chr07	8844747	0.122686	WM
chr07	9757894	0.486993	WM
chr07	13945321	0.150714	WM
chr07	17138888	0.0357143	WM
chr07	20740106	0.480791	WM
chr07	21017601	0.412994	WM
chr07	25393745	0.363842	WM
chr08	2829230	0.499736	WM
chr08	5129344	0.404548	WM
chr08	7208859	0.412994	WM
chr08	9883063	0.404548	WM
chr08	12651193	0.412994	WM
chr08	17377683	0	WM
chr08	20401282	0.363842	WM
chr08	21313259	0.494976	WM
chr08	24044740	0.474352	WM
chr08	27696842	0.0333333	WM
chr08	31922009	0.274987	WM
chr08	33321661	0.0677556	WM
chr09	2085720	0.296668	WM
chr09	3478767	0.259322	WM
chr09	6283314	0.475192	WM
chr09	11494498	0.506081	WM
chr09	13469111	0.0677556	WM
chr09	17754201	0.45977	WM
chr09	20413457	0	WM
chr09	20978786	0.474352	WM
chr10	2629013	0.418826	WM
chr10	5517442	0.355368	WM
chr10	6131681	0.355368	WM
chr10	10679647	0.440113	WM
chr10	13063980	0.440113	WM
chr10	16323088	0.312765	WM
chr10	18915293	0.333938	WM
chr10	23836819	0.296668	WM
chr10	25169924	0.49435	WM
chr11	2390244	0.362987	WM
chr11	5805224	0.506494	WM
chr11	8604428	0.274987	WM
chr11	9126598	0.0357143	WM
chr11	13593024	0.290381	WM
chr11	17824984	0.325424	WM
chr11	20249101	0.0936013	WM
chr11	22083887	0.39774	WM
chr11	26731386	0.435572	WM
chr11	27089251	0.401207	WM
chr11	30394628	0.508167	WM
chr12	2241457	0.427119	WM
chr12	4896854	0.0936013	WM
chr12	6562041	0	WM
chr12	9577036	0.499435	WM
chr12	13747388	0.0726765	WM
chr12	16278536	0.317292	WM
chr12	18403942	0.440113	WM
chr12	23762593	0.336859	WM
chr12	24189363	0.503327	WM
```
{{< /admonition >}}

{{< admonition type=abstract title="代码内容+数据结构" open=false >}}

```
setwd("C:/Users/90500/Desktop")
df<-read.table("3k.352.txt",header=F)
pdf("BY9_XZM.pdf",width=4.5,height=4 )
names(df)<-c("group","dm","gs")
#df$group <- factor(df$group,levels=c("BY5","BY7","BY9","BY5_BY7","BY5_BY9","BY7_BY9"))
library(ggplot2)
pi<-ggplot(df,aes(x=group,y=gs,fill=group) )+
  geom_boxplot()+
  scale_fill_manual(values=c("#6495ED","#DC143C"), labels = c("BY9","XZM"))+
  #scale_fill_manual(values=c("#6495ED","#6495ED","#6495ED","#DC143C","#DC143C","#DC143C"), labels = c("BY5","BY7","BY9","BY5_BY7","BY7_BY9","BY5_BY9"))+
  theme_bw()+
  theme(
    axis.text.x =element_text(angle=45,vjust=0.6,face="bold"), 
    axis.text= element_text(size= 8,face="bold"),
    axis.title = element_text(size = 9,face = "bold")
    )+
  ylim(0.955,1)+
  labs(y="Genetic Similarity")+
  theme()
pi
dev.off()
```
{{< /admonition >}}


### 循环跑箱线图
```R
setwd("C:/Users/90500/Desktop/tmp")
library(ggplot2)
library(ggsignif)
library(ggpubr)

file_list<-list.files() #读取路径画图文件

for (x in c(1:length(file_list))){ #批量循环读取文件
   df<-read.table(file_list[x],header=T)
   trait_name<-strsplit(file_list[x],"\\.")[[1]][1]
   print(trait_name)
   names(df)<-c("sample","trait","group")
   df$group <- factor(df$group,levels=c("WildSpecies","Progenitor","Landrace")) #将分组按顺序设置为因子
   df <- subset(df, group != "NA")
   df<-subset(df,df[,2]!="NA")
   df<-subset(df,df[,3]!="WildSpecies") #数据集取子集


   yaxis_max<-as.numeric(max(subset(df,df[,2]!="NA")[,2]))
   yaxis_min<-as.numeric(min(subset(df,df[,2]!="NA")[,2]))
   top<-yaxis_max +(yaxis_max-yaxis_min)/3
   #top<-130
   bottom<-(yaxis_min*7)/8
   #bottom<-50

  p<-ggplot(df,aes(x=group,y=trait,fill=group) )+
  geom_boxplot(outlier.size = 1,outlier.color='grey',)+
  scale_fill_manual(values=c("WildSpecies"='#56B4E9',"Progenitor"="#E69F00","Landrace"="#009E73"), 
  #labels = c("WildSpecies","Progenitor","Landrace"))+
  labels = c("Progenitor","Landrace"))+
  
  geom_signif(  #添加显著性
  #comparisons =  list(c("WildSpecies", "Progenitor"),c("Progenitor", "Landrace"),c("WildSpecies", "Landrace")),
  comparisons =  list(c("Progenitor", "Landrace")),
  #y_position = c((7*(top))/8, 7.2*(top)/8, (7.6*(top))/8), 
  y_position = c( 7.2*(top)/8), 
 # test=t.test,test.args=c('two.sided'), 
  tip_length = 0.01,
  map_signif_level = F)+
  
  theme(
    axis.text.x =element_text(angle=45,vjust=0.6,face="bold"), 
    axis.text= element_text(size= 8,face="bold"),
    axis.title = element_text(size = 9,face = "bold")
    )+
  ylim(bottom,top)+
  #ylim(50,120)+
  labs(y=trait_name)+
  theme_bw()+
  theme()
  t_test_result <- pairwise.t.test(df$trait, df$group)
  t_test_result
  assign(paste("p",x,sep=""),p)
}

p_all<-ggpubr::ggarrange(p1,
  ncol=1,nrow=1,
  common.legend=T,legend="right")
print(p_all)
ggsave('PotatoTraits.pdf',width=4,height=4)
system('explorer.exe PotatoTraits.pdf')


dev.off()

```